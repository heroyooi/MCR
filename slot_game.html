<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
  <title>Made Coupon</title>
  <link rel="stylesheet" href="css/pretendard.css">
  <link rel="stylesheet" href="css/common.css">
  <script src="js/jquery.min.js"></script>
  <script src="js/jquery-ui.min.js"></script>
  <script src="js/jquery.cookie.js"></script>
  <script src="js/jquery.magnific-popup.min.js"></script>
  <script src="js/aos.js"></script>
  <script src="js/swiper.js"></script>
  <script src="js/ui.js"></script>
</head>
<body class="bg_green">
  <div id="wrapper">
    <div id="header">
      <div class="h-inner hide-750">
        <div class="h-left">
          <h1><a href="#">Made Coupon</a></h1>
          <ul id="gnb">
            <li><a href="#">선물하기</a></li>
            <li><a href="#">상품권교환소</a></li>
            <li><a href="#">마일리지충전소</a></li>
            <li><a href="#">이벤트</a></li>
          </ul>
        </div><!-- .h-left -->
        <div class="h-right hide-750">
          <div class="search-form">
            <input type="text" placeholder="상품명, 브랜드 검색" />
            <a href="#" class="btn-search">검색</a>
          </div>
          <a href="#" class="btn-join" style="display: none;">로그인/회원가입</a>
          <a href="#" class="btn-mypage">마이페이지</a>
        </div><!-- .h-right -->
      </div><!-- .h-inner -->
      <div class="h-inner only-mobile show-750 flex">
        <a href="#" class="m-btn-back">뒤로 가기</a>
        <h2 class="sub-tit">두근두근 언박싱</h2>
        <a href="#" class="m-btn-home">홈</a>
      </div>
    </div><!-- #header -->
      
    <div id="container">
      <div class="content-wrap">
        <h2 class="con-tit hide-750">두근두근 언박싱</h2>
        <div class="slot-machine-area">
          <div class="slot-machine">
            <div class="slot-window">
              <ul class="slot-track" id="slot-track"></ul>
            </div>
          </div><!-- .slot-machine -->
          <span class="particle" data-aos="fade-down" data-aos-duration="1500"><img src="/img/promotion/bg_particle.png" alt=""></span>
          
          <ul class="event-info-list">
            <li class="on" id="start-btn">
              <span class="label">잔여 <em class="count">14</em>회</span>
              <span class="name">두근두근 언박싱 시작</span>
            </li>
            <li>
              <span class="label">잔여 0회</span>
              <span class="name">언박싱 완료</span>
            </li>
            <li>
              <span class="label">잔여 10회</span>
              <span class="name">언박싱 기간 만료</span>
            </li>
          </ul>
        </div><!-- .slot-machine-area -->
      </div><!-- .content-wrap -->
    </div><!-- #container -->

    <div id="footer">
      <div class="f-inner">
        <ul class="menu">
          <li><a href="">회사소개</a></li>
          <li><a href="">이용약관</a></li>
          <li><a href="">개인정보처리방침</a></li>
          <li><a href="">고객센터</a></li>
        </ul>
        <div class="address-area">
          <dl class="address">
            <dt>메이드쿠폰 사업자 정보</dt>
            <dd>
              <ul>
                <li>
                  <span class="label">회사명</span>
                  <span class="value">㈜엔버</span>
                </li>
                <li>
                  <span class="label">대표이사</span>
                  <span class="value">이광용</span>
                </li>
                <li>
                  <span class="label">사업자등록번호</span>
                  <span class="value">465 88 00127</span>
                </li>
                <li>
                  <span class="label">통신판매업</span>
                  <span class="value">제 2016 서울광진 1141 호</span>
                </li>
                <li>
                  <span class="label">개인정보관리책임자</span>
                  <span class="value">전준상</span>
                </li>
                <li>
                  <span class="label">주소</span>
                  <span class="value">서울 강남구 봉은사로 47 길 12 진현빌딩 2 동 401 호</span>
                </li>
              </ul>
              <p class="copy">Copyright ⓒ 메이드쿠폰 MadeCoupon All RightsReserved</p>
            </dd>
          </dl>
        </div>
      </div>
    </div><!-- #footer -->

    <div class="fm-wrap">
      <ul>
        <li class="menu"><a href="#"></a></li>
        <li class="home"><a href="#"></a></li>
        <li class="my"><a href="#"></a></li>
        <li class="gift"><a href="#"></a></li>
      </ul>
    </div><!-- .fm-wrap -->

    <button class="btn-top">위로 가기</button>

    <div class="menu-dimm"></div>
    <div class="menu-wrap">
      <div class="m-header">
        <h1>메이드쿠폰 메뉴</h1>
        <a class="btn-close" href="#">닫기</a>
      </div>
      <div class="m-container">
        <ul>
          <li class="menu-1"><a href="#"><span>선물하기</span></a></li>
          <li class="menu-2"><a href="#"><span>상품권 보관소</span></a></li>
          <li class="menu-3"><a href="#"><span>상품권 지갑</span></a></li>
          <li class="menu-4"><a href="#"><span>마일리지 충전소</span></a></li>
          <li class="menu-5"><a href="#"><span>마일리지 선물하기</span></a></li>
          <li class="menu-6"><a href="#"><span>마이페이지</span></a></li>
          <li class="menu-7"><a href="#"><span>공지사항</span></a></li>
          <li class="menu-8"><a href="#"><span>1:1 문의</span></a></li>
          <li class="menu-9"><a href="#"><span>이벤트</span></a></li>
        </ul>
      </div>
    </div><!-- .menu-wrap -->

    <div class="popup-wrap z-anim mfp-hide" id="popup-winner" data-width="348">
      <div class="popup-inner">
        <a href="#" class="btn-close b-mfp-close">닫기</a>
        <span class="fanfare"><img src="img/common/ic_fanfare.svg" alt=""></span>
        <div class="con-wrap">
          <p class="tit">당첨 축하합니다!</p>
          <p class="name">스타벅스아메리카노상품명아메리카노상품명아메리카노상품명</p>
          <p class="price">정가 10,000원</p>
          <div class="gift-area">
            <!-- <img src="img/promotion/sample_gift_1.png" alt=""> -->
          </div>
          <div class="btn-base-wrap center">
            <span class="btn-base tp1 green"><a href="#">언박싱상품보기</a></span>
          </div>
        </div><!-- .con-wrap -->
        <div class="btn-wrap">
          
        </div>
      </div><!-- .popup-inner -->
    </div><!-- .popup-wrap -->

  </div><!-- #wrapper -->

  <script>
    let remainingChances = 14;
    const slotHeight = 140;
    const spinRounds = 3;

    // 사용할 브랜드 이미지 리스트
    const brands = [
      {
        img: 'img/promotion/sample_gift_1.png',
        alt: '스타벅스아메리카노',
      },
      {
        img: 'img/promotion/sample_gift_2.png',
        alt: '베스킨라빈스',
      },
      {
        img: 'img/promotion/sample_gift_3.png',
        alt: '파리바게뜨 5,000원 쿠폰',
      },
      {
        img: 'img/promotion/sample_gift_4.png',
        alt: '메이드쿠폰 5,000원 쿠폰',
      },
      {
        img: 'img/promotion/sample_gift_5.png',
        alt: 'CU 편의점 3,000원 쿠폰',
      },
      {
        img: 'img/promotion/sample_gift_6.png',
        alt: '파리바게뜨 상품권 파리바게뜨 상품권 파리바게뜨 상품권 파리바게뜨 상품권',
      },
    ];

    // ✅ 설정 옵션
    const config = {
      direction: 'up',   // 'up' 또는 'down'
      mode: 'random',    // 'random' 또는 'fixed'
      fixedIndex: 2      // mode가 'fixed'일 때 당첨 인덱스
    };

    // 슬롯 아이템 채우기
    const $track = $('#slot-track');
    $track.empty();
    const repeatCount = 10;
    for (let i = 0; i < brands.length * repeatCount; i++) {
      const img = brands[i % brands.length].img;
      const alt = brands[i % brands.length].alt;
      $track.append(`<li><img src="${img}" alt="${alt}" /></li>`);
    }

    $('#start-btn').on('click', function () {
      if (remainingChances <= 0) {
        alert('뽑기 횟수가 모두 소진되었습니다.');
        return;
      }

      $('.popup-wrap#popup-winner .con-wrap .gift-area').empty();

      remainingChances--;
      $('#start-btn .count').text(remainingChances);

      const totalItems = $('#slot-track li').length;
      const baseIndex = config.mode === 'fixed'
        ? config.fixedIndex
        : Math.floor(Math.random() * brands.length);
      const stopIndex = (brands.length * spinRounds) + baseIndex;
      const targetY = config.direction === 'up'
        ? -1 * stopIndex * slotHeight
        : stopIndex * slotHeight;

      $track.css({
        transform: 'translateY(0)',
        transition: 'none'
      });

      setTimeout(() => {
        $track.css({
          transform: `translateY(${targetY}px)`,
          transition: 'transform 2s cubic-bezier(0.33, 1, 0.68, 1)'
        });
      }, 50);

      setTimeout(() => {
        const selectedIndex = baseIndex % brands.length;
        $('.popup-wrap#popup-winner .con-wrap .name').text(brands[selectedIndex].alt);
        $('.popup-wrap#popup-winner .con-wrap .gift-area').append(`<img src=${brands[selectedIndex].img} alt=${brands[selectedIndex].alt} />`);
        $.magnificPopup.open(getOptions('#popup-winner'));
      }, 2100);
    });

    var Qsample = $.urlParam('sample');
    var Qpopup = $.urlParam('popup');
    if (Qsample || Qpopup) {
      setTimeout(() => {
        if (Qsample === 'menu') {
          $('.fm-wrap li.menu a').click();
        }
        if (Qpopup === 'winner') {
          $.magnificPopup.open(getOptions('#popup-winner'));
        }
      }, 250);
    }
  </script>
</body>
</html>